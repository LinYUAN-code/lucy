import{_ as z,u as H,s as J,r as K,a as d,c as D,o as O,x as y,b as v,d as T,e as C,f as G,t as m,g as w,h as l,w as i,n as Q,v as U,k as x,F as W,j as X,y as Y,L as Z}from"./index-5a10908c.js";/* empty css                                                                    */import{D as N}from"./D3Graph-e7774137.js";const V={class:"analysis"},I={class:"argument"},nn={class:"el-dropdown-link"},rn={class:"control-btn"},an={__name:"Automaton",setup(on){const s=H(),F=J();K({}),d(!1);const u=d(null),$=D(()=>s.getters["grammarStore/getStartTNonTer"]),b=d([]),S=d([]),B=r=>{let t=[];r!=null&&r.length&&(r.forEach(e=>{var a;(a=e==null?void 0:e.edges)!=null&&a.length&&e.edges.forEach(n=>{var _,g,h,k,f;b.value=[...b.value,((_=n==null?void 0:n.next)==null?void 0:_.id)===-1?`id [label="Accept" shape="none" style="none" ] id${e.id} -> id [ xlabel="${n==null?void 0:n.tocken}"]`:`id${(g=n==null?void 0:n.next)==null?void 0:g.id} [label="S${(h=n==null?void 0:n.next)==null?void 0:h.id}
${(k=n==null?void 0:n.next)==null?void 0:k.items.join(`
`)}"] id${e.id} -> id${(f=n==null?void 0:n.next)==null?void 0:f.id} [ xlabel="${n==null?void 0:n.tocken}"]`],n!=null&&n.next&&(t=[...t,n==null?void 0:n.next])})}),S.value=t)},L=D(()=>s.getters["grammarStore/getNonTerminal"]),j=()=>{const r=s.getters["grammarStore/getLRParser"],t=s.getters["grammarStore/getGrammar"],e=s.getters["grammarStore/getTerminal"];r.generateState(t,$.value,L.value,e);const a=r.stateGraph;s.commit("grammarStore/updateArgument",a==null?void 0:a.items[0]),console.log(a),b.value=[`id${a==null?void 0:a.id} [label="S${a==null?void 0:a.id}
${a==null?void 0:a.items.join(`
`)}"] `],S.value=[a];let n=0;for(;S.value.length&&!(n>=5);)B(S.value),n+=1;s.commit("grammarStore/updateGraph",b.value)},p=D(()=>s.getters["grammarStore/getGraph"]),E=D(()=>s.getters["grammarStore/getArgument"]),o=d(1),P=()=>{var r;o.value<=0||(o.value=o.value-1,u.value.setDotIndexForGraph(o.value),(r=u.value)==null||r.render(c.value))},M=()=>{var r;o.value>=p.value.length||(o.value=o.value+1,u.value.setDotIndexForGraph(o.value),(r=u.value)==null||r.render(c.value))};O(()=>{var r,t;(r=p.value)!=null&&r.length?(t=u.value)==null||t.render(c.value):j()});const q=r=>{c.value=r},A=["自动播放","手动播放","不播放"],c=d(2);return y(()=>$,(r,t)=>{r.value?t==null&&setTimeout(()=>{var e;(e=u.value)==null||e.render(c.value)},1e3):F.push(Z[1].route)},{immediate:!0,deep:!0}),y([()=>p.value,c],([r,t],[e,a])=>{var n,_;r.length&&t!=null&&(o.value=1,(n=u.value)==null||n.setDotIndexForGraph(o.value),(_=u.value)==null||_.render(t,r))},{deep:!0}),(r,t)=>{const e=v("arrow-down"),a=v("el-icon"),n=v("el-dropdown-item"),_=v("el-dropdown-menu"),g=v("el-dropdown"),h=v("el-button"),k=v("ArrowRight");return T(),C("div",V,[G("div",I,[G("span",null,"增广语法产生式："+m(w(E)),1),l(g,{onCommand:q},{dropdown:i(()=>[l(_,null,{default:i(()=>[(T(),C(W,null,X(A,(f,R)=>l(n,{key:f,command:R,disabled:c.value===R},{default:i(()=>[x(m(f),1)]),_:2},1032,["command","disabled"])),64))]),_:1})]),default:i(()=>[G("span",nn,[x(m(A[c.value])+" ",1),l(a,{class:"el-icon--right"},{default:i(()=>[l(e)]),_:1})])]),_:1})]),l(N,{ref_key:"D3GrapghRef",ref:u,graph:w(p),dotIndex:o.value},null,8,["graph","dotIndex"]),Q(G("div",rn,[l(h,{text:"",icon:w(Y),onClick:P,disabled:o.value<=1},{default:i(()=>[x("上一步")]),_:1},8,["icon","disabled"]),l(h,{text:"",onClick:M,disabled:o.value>=w(p).length},{default:i(()=>[x(" 下一步"),l(a,{class:"el-icon--right"},{default:i(()=>[l(k)]),_:1})]),_:1},8,["disabled"]),x(" "+m(o.value)+" / "+m(w(p).length),1)],512),[[U,c.value===1]])])}}},sn=z(an,[["__scopeId","data-v-b908ece7"]]);export{sn as default};
