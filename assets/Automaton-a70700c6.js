import{_ as H,u as J,s as K,r as O,a as v,c as G,o as Q,x as T,b as p,d as C,e as F,f as $,t as m,g as w,h as l,w as i,n as U,v as W,l as x,F as X,j as Y,y as Z,L as N}from"./index-2f3eb120.js";/* empty css                                                                    */import{D as V}from"./D3Graph-ee39ffd8.js";const I={class:"analysis"},nn={class:"argument"},an={class:"el-dropdown-link"},rn={class:"control-btn"},on={__name:"Automaton",setup(tn){const s=J(),B=K();O({}),v(!1);const u=v(null),k=G(()=>s.getters["grammarStore/getStartTNonTer"]),S=v([]),b=v([]),A=v(new Set),L=a=>{let e=[];a!=null&&a.length&&(a.forEach(o=>{var r;A.value.add(o.id),(r=o==null?void 0:o.edges)!=null&&r.length&&o.edges.forEach(n=>{var _,g,h,D,f;S.value=[...S.value,((_=n==null?void 0:n.next)==null?void 0:_.id)===-1?`id [label="Accept" shape="none" style="none" ] id${o.id} -> id [ xlabel="${n==null?void 0:n.tocken}"]`:`id${(g=n==null?void 0:n.next)==null?void 0:g.id} [label="S${(h=n==null?void 0:n.next)==null?void 0:h.id}
${(D=n==null?void 0:n.next)==null?void 0:D.items.join(`
`)}"] id${o.id} -> id${(f=n==null?void 0:n.next)==null?void 0:f.id} [ xlabel="${n==null?void 0:n.tocken}"]`],n!=null&&n.next&&!A.value.has(n.next.id)&&e.push(n.next)})}),b.value=e)},j=G(()=>s.getters["grammarStore/getNonTerminal"]),E=()=>{const a=s.getters["grammarStore/getLRParser"],e=s.getters["grammarStore/getGrammar"],o=s.getters["grammarStore/getTerminal"];a.generateState(e,k.value,j.value,o);const r=a.stateGraph;for(s.commit("grammarStore/updateArgument",r==null?void 0:r.items[0]),console.log(r),S.value=[`id${r==null?void 0:r.id} [label="S${r==null?void 0:r.id}
${r==null?void 0:r.items.join(`
`)}"] `],b.value=[r];b.value.length;)L(b.value);s.commit("grammarStore/updateGraph",S.value)},d=G(()=>s.getters["grammarStore/getGraph"]),P=G(()=>s.getters["grammarStore/getArgument"]),t=v(1),M=()=>{var a;t.value<=0||(t.value=t.value-1,u.value.setDotIndexForGraph(t.value),(a=u.value)==null||a.render(c.value))},q=()=>{var a;t.value>=d.value.length||(t.value=t.value+1,u.value.setDotIndexForGraph(t.value),(a=u.value)==null||a.render(c.value))};Q(()=>{var a,e;(a=d.value)!=null&&a.length?(e=u.value)==null||e.render(c.value):E()});const z=a=>{c.value=a},R=["自动播放","手动播放","不播放"],c=v(2);return T(()=>k,(a,e)=>{a.value?e==null&&setTimeout(()=>{var o;(o=u.value)==null||o.render(c.value)},1e3):B.push(N[1].route)},{immediate:!0,deep:!0}),T([()=>d.value,c],([a,e],[o,r])=>{var n,_;a.length&&e!=null&&(t.value=1,(n=u.value)==null||n.setDotIndexForGraph(t.value),(_=u.value)==null||_.render(e,a))},{deep:!0}),(a,e)=>{const o=p("arrow-down"),r=p("el-icon"),n=p("el-dropdown-item"),_=p("el-dropdown-menu"),g=p("el-dropdown"),h=p("el-button"),D=p("ArrowRight");return C(),F("div",I,[$("div",nn,[$("span",null,"增广语法产生式："+m(w(P)),1),l(g,{onCommand:z},{dropdown:i(()=>[l(_,null,{default:i(()=>[(C(),F(X,null,Y(R,(f,y)=>l(n,{key:f,command:y,disabled:c.value===y},{default:i(()=>[x(m(f),1)]),_:2},1032,["command","disabled"])),64))]),_:1})]),default:i(()=>[$("span",an,[x(m(R[c.value])+" ",1),l(r,{class:"el-icon--right"},{default:i(()=>[l(o)]),_:1})])]),_:1})]),l(V,{ref_key:"D3GrapghRef",ref:u,graph:w(d),dotIndex:t.value},null,8,["graph","dotIndex"]),U($("div",rn,[l(h,{text:"",icon:w(Z),onClick:M,disabled:t.value<=1},{default:i(()=>[x("上一步")]),_:1},8,["icon","disabled"]),l(h,{text:"",onClick:q,disabled:t.value>=w(d).length},{default:i(()=>[x(" 下一步"),l(r,{class:"el-icon--right"},{default:i(()=>[l(D)]),_:1})]),_:1},8,["disabled"]),x(" "+m(t.value)+" / "+m(w(d).length),1)],512),[[W,c.value===1]])])}}},un=H(on,[["__scopeId","data-v-4920ffb9"]]);export{un as default};
