import{_ as I,u as N,c as x,r as j,i as d,a as T,o as V,b as h,d as i,e as f,f as v,t as b,g as P,h as L,w as S,F as C,j as E,k as F,l as R,p as B,m as M,n as D,v as J,q as H,E as $}from"./index-fe6a51a4.js";const q=_=>(B("data-v-de099632"),_=_(),M(),_),W={class:"dialog-body"},z={class:"content"},A={class:"handle"},K={class:"btn-container"},O={class:"support-grammers-list"},Q=q(()=>v("span",{class:"preview"},"预览处理结果",-1)),X={__name:"FormatTip",props:{needHandle:{type:Array,required:!0}},emits:["saveGrammar"],setup(_,{emit:t}){const l=_,c=N(),p=e=>{for(let r in n)a.value.includes(n[r].handleText)&&(e=n[r].handle(e));return e},w=x(()=>c.getters["grammarStore/getGrammar"]),k=()=>{let e=w.value;return a.value.length&&(e=p(e)),e},g=()=>{if(a.value.length){let e=w.value;t("saveGrammar",p(e))}},n=j({needUnion:{text:"同类项",handleText:"合并同类项",handle:e=>d.unionGrammers(e)},needLiftUp:{text:"左公因子",handleText:"提取左公因子",handle:e=>d.liftUpCommonTocken(e)},needClearRecursion:{text:"左递归",handleText:"消除左递归",handle:e=>d.clearRightRecursion(e)}}),y=x(()=>{let e="";return l.needHandle.forEach((r,o)=>{e+=n[r].text,o<l.needHandle.length-1&&(e+="/")}),e}),a=T([]);return V(()=>{a.value=l.needHandle.map(e=>n[e].handleText)}),(e,r)=>{const o=h("el-checkbox"),u=h("el-checkbox-group"),m=h("el-button"),G=h("el-popover");return i(),f("div",W,[v("div",z,"检测到该文法存在"+b(P(y))+"，是否需要进行文法改写？",1),L(u,{modelValue:a.value,"onUpdate:modelValue":r[0]||(r[0]=s=>a.value=s),class:"checkbox"},{default:S(()=>[(i(!0),f(C,null,E(l.needHandle,s=>(i(),F(o,{key:s,label:n[s].handleText,size:"large"},null,8,["label"]))),128))]),_:1},8,["modelValue"]),v("div",A,[v("div",K,[L(m,{type:"primary",onClick:g},{default:S(()=>[R("确定")]),_:1})]),L(G,{placement:"top",width:250,trigger:"hover"},{reference:S(()=>[Q]),default:S(()=>[v("ul",O,[(i(!0),f(C,null,E(k(),s=>(i(),f("li",{key:s},b(s),1))),128))])]),_:1})])])}}},Y=I(X,[["__scopeId","data-v-de099632"]]);const Z={class:"judge"},ee={class:"conclusion"},te={__name:"GrammarJudge",setup(_){const t=N(),l=T(!0),c=T([]),p=T(!1),w=x(()=>t.getters["grammarStore/getShowInitail"]),k=x(()=>t.getters["grammarStore/getCustomMode"]),g=x(()=>t.getters["grammarStore/getGrammar"]),n=()=>{const a=t.getters["grammarStore/getLL1Parser"],e=t.getters["grammarStore/getFirstSet"],r=t.getters["grammarStore/getFollowSet"],o=a.getPredictTable(e,r);if(!o.length)return;let u=!0;try{o.forEach(m=>{const{terminal2Derivation:G={}}=m;G.forEach(s=>{const{derivations:U=[]}=s;if(U.length>1)throw u=!1,new Error("End")})})}catch(m){if(m.message!=="End")throw m}if(l.value=u,!k.value&&(c.value=[],d.checkNeedunionGrammers(g.value)&&c.value.push("needUnion"),d.checkNeedliftUpCommonTocken(g.value)&&c.value.push("needLiftUp"),d.checkNeedClearRightRecursion(g.value)&&c.value.push("needClearRecursion"),c.value.length>0)){p.value=!0;return}p.value=!1},y=a=>{if(!k.value){try{const{nonTerminals:e,terminals:r}=d.getTockFromSimpleGrammers(a);t.commit("grammarStore/updateNonTerminal",e),t.commit("grammarStore/updateTerminal",r),t.commit("grammarStore/updateInitialGrammar",g.value),t.commit("grammarStore/updateGrammar",a);const o=new d.LL1Parser(r,e,a),u=o.getFirstSet(),m=o.getFollowSet(u);t.commit("grammarStore/updateLL1Parser",o),t.commit("grammarStore/updateFirstSet",u),t.commit("grammarStore/updateFollowSet",m)}catch{$({message:"操作失败",type:"error"});return}n()}};return V(()=>{n()}),(a,e)=>{const r=h("Warning"),o=h("el-icon");return D((i(),f("div",Z,[v("div",ee,[l.value?H("",!0):(i(),F(o,{key:0},{default:S(()=>[L(r)]),_:1})),R(" 该文法"+b(l.value?"":"不")+"是LL1文法 ",1)]),p.value?(i(),F(Y,{key:0,needHandle:c.value,onSaveGrammar:y},null,8,["needHandle"])):H("",!0)],512)),[[J,!P(w)]])}}},ae=I(te,[["__scopeId","data-v-77fa2de4"]]);export{ae as default};
