import{_ as me,u as ge,x as _e,c as S,a as i,o as he,z as ye,y as ee,b as d,d as s,e as c,g as L,l as te,h as f,w as k,f as p,q as C,F as R,j as N,n as z,v as K,k as F,B as le,t as U,p as Se,m as ke}from"./index-fce0414d.js";const ae=A=>(Se("data-v-72b427ce"),A=A(),ke(),A),Fe={key:0,class:"first"},Te={key:1,class:"rules-container"},be=ae(()=>p("span",{class:"rules-title"},"规则:",-1)),we={class:"rules"},Le={class:"first"},xe={key:2,class:"rules-container"},Ie=ae(()=>p("span",{class:"rules-title"},"规则:",-1)),Oe={class:"rules"},Ce={__name:"LL1Table",setup(A){const T=ge(),ne=_e(),$=S(()=>ne.currentRoute.value.query.type);let b=i({});const x=i(!1),m=i(0),g=i(!1),I=i([]),G=e=>{m.value=e},re=()=>{x.value=!x.value},D=S(()=>T.getters["grammarStore/getFirstSet"]),V=S(()=>T.getters["grammarStore/getFollowSet"]),M=i(),W=i(),B=i([]),E=i(),se=(e,l,n)=>{var a;if(!e.length)return[];const t=[];for(let r=0;r<e.length;r++)(!l.length||e[r][n]!==((a=l[r])==null?void 0:a[n]))&&e[r][n]&&t.push(e[r].nonTerminal);return t},J=e=>{let l;if(e==="FIRST"?l=j.value.getFirstSetProgressive():e==="FOLLOW"&&(l=j.value.getFollowSetProgressive(D.value)),!l)return;I.value=[],g.value=!1,B.value=l==null?void 0:l.next().value;const n=()=>{var a,r;const t=l.next();if(t.done)m.value=0;else{const u=(a=t.value.result)==null?void 0:a.reduce((v,y)=>(v[y.tocken]=[...y.terminals.values()].length?`{ ${[...y.terminals.values()].sort().join(" , ")} }`:"",v),{}),h=Object.keys(u).map(v=>({nonTerminal:v,[e]:u[v]}));b.value={[e]:se(h,I.value,e)},I.value=h,E.value=(r=t.value)==null?void 0:r.ruleIndex}};W.value=setInterval(n,2500)},Q=S(()=>T.getters["grammarStore/getHideFirset"]),oe=S(()=>T.getters["grammarStore/getNonTerminal"]),ue=S(()=>[...T.getters["grammarStore/getTerminal"],"$"]),O=i([]),j=S(()=>T.getters["grammarStore/getLL1Parser"]),H=e=>e==null?void 0:e.map(l=>{const{nonTerminal:n="",terminal2Derivation:t={}}=l,a=new Map;return t.forEach((r,u)=>{const{derivations:h=[],nonTerminal:v=""}=r,y=h.map(o=>o.length?`${v} => ${o.join(" ")}`:"");a.set(u,y)}),{nonTerminal:n,...Object.fromEntries(a.entries())}}),X=()=>{const e=j.value.getPredictTable(D.value,V.value);if(!e.length)return[];O.value=H(e)};he(()=>{Y(),X()});const P=i([]),ie=(e,l)=>!!((e==null?void 0:e.length)===(l==null?void 0:l.length)&&e.filter(n=>!l.includes(n))),_=i([]),q=i(),ce=(e,l)=>{if(!e.length)return[];const n=[];for(let t=0;t<e.length;t++)for(let a in e[t])(!l.length||Array.isArray(e[t][a])&&!ie(e[t][a],l[t][a])||!Array.isArray(e[t][a])&&e[t][a]!==l[t][a])&&n.push({[a]:e[t].nonTerminal});return n},ve=()=>{g.value=!g.value},de=()=>{m.value=!1,O.value=[];const e=j.value.getPredictTableProgressive(D.value,V.value);P.value=e.next().value;const l=()=>{var t,a,r,u;const n=e.next();n.done?g.value=!1:(_.value=ce(H((t=n.value)==null?void 0:t.result),O.value),_.value[0]&&(b.value={[((a=n.value)==null?void 0:a.ruleIndex)===0?"FIRST":"FOLLOW"]:Object.values(_.value[0])[0]}),O.value=H((r=n.value)==null?void 0:r.result),q.value=(u=n.value)==null?void 0:u.ruleIndex)};M.value=setInterval(l,2500)};ye(()=>{clearInterval(M.value),clearInterval(W.value)});const Y=()=>{const e=D.value.reduce((t,a)=>(t[a.tocken]=`{ ${[...a.terminals.values()].join(" , ")} }`,t),{}),l=V.value.reduce((t,a)=>(t[a.tocken]=`{ ${[...a.terminals.values()].join(" , ")} }`,t),{}),n=oe.value.map(t=>({nonTerminal:t,FIRST:e[t],FOLLOW:l[t]}));I.value=n},fe=({row:e,column:l})=>{for(let n=0;n<_.value.length;n++)if(l.rawColumnKey===Object.keys(_.value[n])[0]&&e.nonTerminal===Object.values(_.value[n])[0])return"highlight";return""},pe=({row:e,column:l})=>{const n=Object.keys(b.value),t=Object.values(b.value);let a="";for(let r=0;r<n.length;r++)l.label===n[r]&&(!Array.isArray(t[r])&&e.nonTerminal===t[r]&&(a="highlight"),Array.isArray(t[r])&&t[r].forEach(u=>{e.nonTerminal===u&&(a="highlight")}));return a};return ee(()=>g,e=>{clearInterval(M.value),_.value=[],b.value={},P.value=[],q.value=-1,e.value?de():X()},{deep:!0}),ee(()=>m,e=>{clearInterval(W.value),E.value=-1,b.value={},e.value===1?J("FIRST"):e.value===2?J("FOLLOW"):Y()},{deep:!0}),(e,l)=>{const n=d("View"),t=d("Hide"),a=d("el-icon"),r=d("el-tooltip"),u=d("el-table-column"),h=d("el-table"),v=d("VideoPlay"),y=d("CircleClose");return s(),c("div",{class:"table",onClick:l[2]||(l[2]=(...o)=>e.showData&&e.showData(...o))},[L(Q)?C("",!0):(s(),c("div",Fe,[te("First Set & Follow Set "),f(r,{class:"box-item",effect:"dark",content:x.value?"显示":"隐藏",placement:"top"},{default:k(()=>[f(a,{onClick:re},{default:k(()=>[x.value?(s(),F(n,{key:0})):(s(),F(t,{key:1}))]),_:1})]),_:1},8,["content"]),p("span",{onClick:l[0]||(l[0]=o=>G(1))},"计算First Set"),p("span",{onClick:l[1]||(l[1]=o=>G(2))},"计算Follow Set")])),B.value.length&&m.value!==0?(s(),c("div",Te,[be,p("ul",we,[(s(!0),c(R,null,N(B.value,(o,w)=>(s(),c("li",{key:o,class:le({high:E.value===w})},U(o),3))),128))])])):C("",!0),z(f(h,{data:I.value,border:"","cell-class-name":pe,style:{"max-width":"700px"}},{default:k(()=>[f(u,{prop:"nonTerminal",label:"",align:"center",width:"150"}),m.value!==2?(s(),F(u,{key:0,prop:"FIRST",label:"FIRST",align:"center"})):C("",!0),m.value!==1?(s(),F(u,{key:1,prop:"FOLLOW",label:"FOLLOW",align:"center"})):C("",!0)]),_:1},8,["data"]),[[K,!x.value&&!L(Q)]]),z(p("div",Le,[te("LL(1)分析表 "),f(r,{class:"box-item",effect:"dark",content:g.value?"退出播放":"播放",placement:"top"},{default:k(()=>[f(a,{onClick:ve},{default:k(()=>[g.value?(s(),F(y,{key:1})):(s(),F(v,{key:0}))]),_:1})]),_:1},8,["content"])],512),[[K,L($)!=="0"]]),P.value.length&&L($)!=="0"?(s(),c("div",xe,[Ie,p("ul",Oe,[(s(!0),c(R,null,N(P.value,(o,w)=>(s(),c("li",{key:o,class:le({high:q.value===w})},U(o),3))),128))])])):C("",!0),z(f(h,{data:O.value,"max-height":"600",border:"",class:"table-data","cell-class-name":fe,style:{"max-width":"700px"}},{default:k(()=>[f(u,{fixed:"",prop:"nonTerminal",label:"",width:"150",align:"center"}),(s(!0),c(R,null,N(L(ue),o=>(s(),F(u,{key:o,prop:o,label:o,align:"center"},{default:k(w=>[p("ul",null,[(s(!0),c(R,null,N(w.row[w.column.rawColumnKey],Z=>(s(),c("li",{key:Z},U(Z),1))),128))])]),_:2},1032,["prop","label"]))),128))]),_:1},8,["data"]),[[K,L($)!=="0"]])])}}},De=me(Ce,[["__scopeId","data-v-72b427ce"]]);export{De as default};
